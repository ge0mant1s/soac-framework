[
  {
    "id": "PA-001",
    "useCase": "Intrusion",
    "detectionRule": "Hosts repeatedly connecting to the same external IP (possible beaconing/C2).",
    "incidentRule": "Pattern sustained across multiple hosts or windows; verify with EDR/DNS intel.",
    "severity": "High",
    "mitreTactic": "Command and Control",
    "mitreTechnique": "T1071.001 (Web Protocols)",
    "category": "Beaconing",
    "cqlQuery": "#repo = paloalto\n| event.panw.panos.action = allow\n| groupBy([event.source.ip, event.destination.ip, event.destination.port],\n          function=count(as=\"sessions\"),\n          limit=100000)\n| sessions >= 200\n| sort(field=sessions, order=desc, limit=2000)",
    "enabled": true,
    "createdAt": "2025-11-04T21:38:22.534241",
    "lastModified": "2025-11-12T21:38:22.534262"
  },
  {
    "id": "PA-002",
    "useCase": "Attack Against Data",
    "detectionRule": "Large outbound bytes to the same external ASN or domain group (exfiltration risk).",
    "incidentRule": ">= 1 GB to non-corporate ASN or many destinations; align with DLP alerts.",
    "severity": "High",
    "mitreTactic": "Exfiltration",
    "mitreTechnique": "T1041 (Exfiltration Over C2 Channel)",
    "category": "Data Exfiltration",
    "cqlQuery": "#repo = paloalto\n| event.panw.panos.action = allow\n| groupBy([event.source.ip, event.destination.as.organization.name],\n          function=sum(event.source.bytes, as=\"bytes_out\"),\n          limit=100000)\n| bytes_out >= 1000000000\n| sort(field=bytes_out, order=desc, limit=2000)",
    "enabled": true,
    "createdAt": "2025-10-31T21:38:22.534326",
    "lastModified": "2025-11-12T21:38:22.534330"
  },
  {
    "id": "PA-003",
    "useCase": "Intrusion",
    "detectionRule": "Traffic to rare destination countries for the org.",
    "incidentRule": "Multiple sources to the same rare country or risky ASN.",
    "severity": "Medium-High",
    "mitreTactic": "Command and Control",
    "mitreTechnique": "T1071.001 (Web Protocols)",
    "category": "Geo Anomaly",
    "cqlQuery": "#repo = paloalto\n| event.panw.panos.action = allow\n| event.destination.geo.country_name !~ /(Spain|Switzerland|Germany|France|United Kingdom|United States)/i\n| groupBy([event.destination.geo.country_name, event.source.ip],\n          function=count(as=\"sessions\"),\n          limit=100000)\n| sessions >= 50\n| sort(field=sessions, order=desc, limit=2000)",
    "enabled": true,
    "createdAt": "2025-11-02T21:38:22.534372",
    "lastModified": "2025-11-12T21:38:22.534376"
  },
  {
    "id": "PA-004",
    "useCase": "Misconfiguration / DoS",
    "detectionRule": "Spike in TCP reset end reasons (e.g., tcp-rst-from-client/server).",
    "incidentRule": "Burst tied to a destination ASN or a single rule; investigate reachability/attack.",
    "severity": "Medium",
    "mitreTactic": "Impact",
    "mitreTechnique": "T1498 (Network DoS)",
    "category": "Stability Issues",
    "cqlQuery": "#repo = paloalto\n| event.panw.panos.action = allow\n| groupBy([event.panw.panos.endreason, event.destination.as.organization.name],\n          function=count(as=\"events\"),\n          limit=100000)\n| events >= 200\n| sort(field=events, order=desc, limit=2000)",
    "enabled": true,
    "createdAt": "2025-10-17T21:38:22.534414",
    "lastModified": "2025-11-12T21:38:22.534417"
  },
  {
    "id": "PA-005",
    "useCase": "Intrusion",
    "detectionRule": "SSL traffic on uncommon destination ports (not 443/8443/9443).",
    "incidentRule": "Many hosts toward the same uncommon port; potential covert tunnel.",
    "severity": "Medium-High",
    "mitreTactic": "Defense Evasion",
    "mitreTechnique": "T1090 (Proxy)",
    "category": "Tunneling",
    "cqlQuery": "#repo = paloalto\n| event.panw.panos.action = allow\n| event.network.application = ssl\n| (event.destination.port !in [443, 8443, 9443])\n| groupBy([event.source.ip, event.destination.ip, event.destination.port],\n          function=count(as=\"sessions\"),\n          limit=100000)\n| sessions >= 20\n| sort(field=sessions, order=desc, limit=2000)",
    "enabled": true,
    "createdAt": "2025-11-05T21:38:22.534452",
    "lastModified": "2025-11-12T21:38:22.534455"
  },
  {
    "id": "PA-006",
    "useCase": "Misconfiguration / Poor Security",
    "detectionRule": "Unknown apps or high risk level (>=4) permitted by policy.",
    "incidentRule": "Same rule allows large volume; tighten rulebase or enable App-ID controls.",
    "severity": "High",
    "mitreTactic": "Defense Evasion",
    "mitreTechnique": "T1562 (Impair Defenses)",
    "category": "Policy Gaps",
    "cqlQuery": "#repo = paloalto\n| event.panw.panos.action = allow\n| (event.network.application =~ /^unknown-/i or event.panw.panos.application.risk_level >= 4)\n| groupBy([event.rule.name, event.network.application],\n          function=count(as=\"hits\"),\n          limit=100000)\n| hits >= 100\n| sort(field=hits, order=desc, limit=2000)",
    "enabled": true,
    "createdAt": "2025-11-07T21:38:22.534490",
    "lastModified": "2025-11-12T21:38:22.534493"
  },
  {
    "id": "PA-007",
    "useCase": "Malware",
    "detectionRule": "Application characteristics include 'used-by-malware' but traffic is allowed.",
    "incidentRule": "Multiple sources or large byte totals; correlate with endpoint alerts.",
    "severity": "High",
    "mitreTactic": "Command and Control",
    "mitreTechnique": "T1071 (Application Layer)",
    "category": "Malicious App Traits",
    "cqlQuery": "#repo = paloalto\n| event.panw.panos.action = allow\n| event.panw.panos.application.characteristics =~ /used-by-malware/i\n| groupBy([event.source.ip, event.network.application],\n          function=[count(as=\"sessions\"), sum(event.network.bytes, as=\"bytes_total\")],\n          limit=100000)\n| sessions >= 10\n| sort(field=sessions, order=desc, limit=2000)",
    "enabled": true,
    "createdAt": "2025-11-09T21:38:22.534534",
    "lastModified": "2025-11-12T21:38:22.534537"
  },
  {
    "id": "PA-008",
    "useCase": "Intrusion / Evasion",
    "detectionRule": "Encrypted-tunnel subcategory heading to external ASNs.",
    "incidentRule": "High volume or many sources to the same ASN.",
    "severity": "Medium-High",
    "mitreTactic": "Defense Evasion",
    "mitreTechnique": "T1090 (Proxy)",
    "category": "Encrypted Tunnels",
    "cqlQuery": "#repo = paloalto\n| event.panw.panos.action = allow\n| event.panw.panos.application.sub_category = encrypted-tunnel\n| groupBy([event.destination.as.organization.name, event.source.ip],\n          function=count(as=\"sessions\"),\n          limit=100000)\n| sessions >= 30\n| sort(field=sessions, order=desc, limit=2000)",
    "enabled": true,
    "createdAt": "2025-10-31T21:38:22.534574",
    "lastModified": "2025-11-12T21:38:22.534581"
  },
  {
    "id": "PA-009",
    "useCase": "Intrusion",
    "detectionRule": "Allowed traffic where egress zone is not INTERNET (potential lateral movement).",
    "incidentRule": "High volume from a single source or to sensitive internal IPs.",
    "severity": "Medium",
    "mitreTactic": "Lateral Movement",
    "mitreTechnique": "T1021 (Remote Services)",
    "category": "Lateral Movement",
    "cqlQuery": "#repo = paloalto\n| event.panw.panos.action = allow\n| event.observer.egress.zone !~ /INTERNET/i\n| groupBy([event.source.ip, event.destination.ip, event.observer.egress.zone],\n          function=count(as=\"sessions\"),\n          limit=100000)\n| sessions >= 50\n| sort(field=sessions, order=desc, limit=2000)",
    "enabled": true,
    "createdAt": "2025-10-31T21:38:22.534614",
    "lastModified": "2025-11-12T21:38:22.534617"
  },
  {
    "id": "PA-010",
    "useCase": "Intrusion",
    "detectionRule": "After-hours surge of allowed sessions by rule.",
    "incidentRule": "Repeated nights or high-risk apps involved.",
    "severity": "Medium-High",
    "mitreTactic": "Collection / C2",
    "mitreTechnique": "T1071 (Application Layer)",
    "category": "Off-hours Activity",
    "cqlQuery": "#repo = paloalto\n| event.panw.panos.action = allow\n| eval(hour = time:hour(@timestamp))\n| (hour < 7 or hour > 20)\n| groupBy([event.rule.name],\n          function=count(as=\"offhour_sessions\"),\n          limit=100000)\n| offhour_sessions >= 200\n| sort(field=offhour_sessions, order=desc, limit=2000)",
    "enabled": true,
    "createdAt": "2025-10-28T21:38:22.534650",
    "lastModified": "2025-11-12T21:38:22.534653"
  },
  {
    "id": "PA-011",
    "useCase": "Intrusion / Evasion",
    "detectionRule": "Single internal source uses many distinct NAT source ports (port hopping).",
    "incidentRule": "Correlate with geo/risky ASN anomalies or beaconing detections.",
    "severity": "Medium",
    "mitreTactic": "Defense Evasion",
    "mitreTechnique": "T1090 (Proxy)",
    "category": "NAT Anomaly",
    "cqlQuery": "#repo = paloalto\n| event.panw.panos.action = allow\n| groupBy([event.source.ip, event.source.nat.port], function=count(as=\"per_port\"), limit=100000)\n| groupBy([event.source.ip], function=[count(as=\"distinct_nat_ports\"), sum(per_port, as=\"sessions\")], limit=100000)\n| distinct_nat_ports >= 200\n| sort(field=distinct_nat_ports, order=desc, limit=2000)",
    "enabled": true,
    "createdAt": "2025-10-27T21:38:22.534683",
    "lastModified": "2025-11-12T21:38:22.534685"
  },
  {
    "id": "PA-012",
    "useCase": "Misconfiguration / Governance",
    "detectionRule": "Identify rules allowing the most bytes for review and tuning.",
    "incidentRule": "Large sudden changes or unexpected top talkers.",
    "severity": "Low-Medium",
    "mitreTactic": "Defense Evasion",
    "mitreTechnique": "T1562 (Impair Defenses)",
    "category": "Rule Tuning",
    "cqlQuery": "#repo = paloalto\n| event.panw.panos.action = allow\n| groupBy([event.rule.name],\n          function=sum(event.network.bytes, as=\"bytes_total\"),\n          limit=100000)\n| sort(field=bytes_total, order=desc, limit=2000)",
    "enabled": true,
    "createdAt": "2025-11-11T21:38:22.534716",
    "lastModified": "2025-11-12T21:38:22.534718"
  }
]